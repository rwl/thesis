\begin{figure}
\centering
\begin{scriptsize}
\begin{tikzpicture}[thick]

\tikzstyle{busbar} = [rectangle,draw,fill=black,inner sep=0pt];
\tikzstyle{hbus} = [busbar,minimum width=10mm,minimum height=2pt,drop shadow];

\coordinate (c1) at (0,3);
\coordinate (c2) at (3.5,4.5);
\coordinate (c3) at (7,3);
\coordinate (c4) at (0,0);
\coordinate (c5) at (3.5,-1.5);
\coordinate (c6) at (7,0);
\coordinate (over) at (0,3.75);


\node[hbus,minimum width=20mm,label=left:Bus 1] (b1) at (c1) {};
\node[hbus,minimum width=30mm,label=left:Bus 2] (b2) at (c2) {};
\node[hbus,minimum width=20mm,label=right:Bus 3] (b3) at (c3) {};
\node[hbus,minimum width=20mm,label=left:Bus 4] (b4) at (c4) {};
\node[hbus,minimum width=30mm,label=left:Bus 5] (b5) at (c5) {};
\node[hbus,minimum width=20mm,label=right:Bus 6] (b6) at (c6) {};

% \busbar{b1}{c1}{20mm}
% \busbar{b2}{c2}{40mm}
% \busbar{b3}{c3}{20mm}
% \busbar{b4}{c4}{20mm}
% \busbar{b5}{c5}{40mm}
% \busbar{b6}{c6}{20mm}

% Branch 1-2.
\draw[line] ([xshift=5mm] b1.north) |- ([xshift=-10mm,yshift=-5mm] b2.south) --
([xshift=-10mm] b2.south);
% Branch 1-4.
\draw[line] ([xshift=-5mm] b1.south) -- ([xshift=-5mm] b4.north);
% Branch 1-5.
\draw[line] ([xshift=5mm] b1.south) -- ([xshift=5mm,yshift=-5mm] b1.south)
-- ([xshift=-5mm,yshift=8mm] b5.north) -- ([xshift=-5mm] b5.north);
% Branch 2-3.
\draw[line] ([xshift=10mm] b2.south) -- ++(0,-0.5) -| ([xshift=-5mm]
b3.north);
% Branch 2-4.
\draw[line] ([xshift=-5mm] b2.south) --
([xshift=-5mm,yshift=-8mm] b2.south) -- ([xshift=5mm,yshift=5mm] b4.north)
-- ([xshift=5mm] b4.north);
% Branch 2-5.
\draw[line] (b2.south) -- (b5.north);
% Branch 2-6.
\draw[line] ([xshift=5mm] b2.south) -- ([xshift=5mm,yshift=-8mm] b2.south)
-- ([xshift=-5mm,yshift=5mm] b6.north) -- ([xshift=-5mm] b6.north);
% Branch 3-5.
\draw[line] ([xshift=-5mm] b3.south) -- ([xshift=-5mm,yshift=-5mm] b3.south)
-- ([xshift=5mm,yshift=8mm] b5.north) -- ([xshift=5mm] b5.north);
% Branch 3-6.
\draw[line] ([xshift=5mm] b3.south) -- ([xshift=5mm] b6.north);
% Branch 4-5.
\draw[line] ([xshift=5mm] b4.south) |- ([xshift=-10mm,yshift=5mm] b5.north) --
([xshift=-10mm] b5.north);
% Branch 5-6.
\draw[line] ([xshift=10mm] b5.north) -- ([xshift=10mm,yshift=5mm] b5.north) -|
([xshift=-5mm] b6.south);

% Generator 1.
\genset{g1}{$(c1)+(-5mm,8mm)$}{label=above:110 MW}
\draw[line] ([xshift=-5mm] b1.north) -- (g1.south);
% Generator 2.
\genset{g2}{$(c2)+(0,8mm)$}{label=above:110 MW}
\draw[line] (b2.north) -- (g2.south);
% Generator 3.
\genset{g3}{$(c3)+(5mm,8mm)$}{label=above:220 MW}
\draw[line] ([xshift=5mm] b3.north) -- (g3.south);

% Load 1.
\draw[loadline] ([xshift=-5mm] b4.south) -- ++(0,-0.8) node[text centered,text
width=10mm,below] {70 MW};
% \loadd{l1}{$(c4)-(5mm,15mm)$}
% \draw[line] (l1.south) -- ([xshift=-5mm] b4.south);
% Load 2.
\draw[loadline] (b5.south) -- ++(0,-0.8) node[text centered,text
width=10mm,below] {70 MW};
% \loadd{l2}{$(c5)-(0mm,15mm)$}
% \draw[line] (l2.south) -- (b5.south);
% Load 3.
\draw[loadline] ([xshift=5mm] b6.south) -- ++(0,-0.8) node[text centered,text
width=10mm,below] {70 MW};
% \loadd{l3}{$(c6)+(5mm,-15mm)$}
% \draw[line] (l3.south) -- ([xshift=5mm] b6.south);

\end{tikzpicture}
\end{scriptsize}
\caption{Single-line diagram for six bus power system model.}
\label{fig:case6ww}
\end{figure}
