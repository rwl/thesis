\chapter{Background}
\label{ch:background}
Competitive power trade is a relatively new practice and is one that has a
number of unique characteristics among commodities.  This chapter provides
background information on electric power supply and the associated wholesale
electricity markets.  It also explains how such markets are simulated and, in
particular, the agent-based approach to this.

\section{Electric Power Systems}
Generation and bulk movement of electricity in the UK takes place in a
three-phase alternating current (AC) power system.  Each of the phases is
high voltage, sinusoidal electrical waveform, $120$ degrees offset in time
and oscillating at a constant frequency of 50Hz.  Synchronous generators (or
alternators), typically rotating at 3600rpm or 1800rpm, generate apparent power
$S$ at a line voltage $V_l$ typically between
11kV and 25kV.  One of the prinicpal reasons that alternating current, and not
direct current (DC), systems are common in electricity supply is that they
allow power to be transformed between voltages with very high efficiency.  The
apparent power conducted by a line $l$ is the product of the line current
$I_l$ and the line voltage
\begin{equation}
S = \sqrt{3} V_l I_l .
\end{equation}
Thus increasing the voltage has an inverse effect on the current.
Ohmic heating losses are proportional to the square of line current
\begin{equation}
P_{r} = 3 I_l^2 R
\end{equation}
where $R$ is the resistance of the line.  Hence reducing the line current
causes a dramatic reduction in heating losses.  One consequence of higher
voltages is the larger extent and integrity of conductor insulation required between
one another, neutral and earth.  This results in necessity for large
transmission towers and in high cable costs when undergrounding systems.

The UK transmission system operates at 400kV and 275kV (plus 132kV in
Scotland), but systems with voltages upto and beyond 1000kV are used in certain
larger countries\footnote{For transmission over very long distances or
undersea, high voltage DC systems have become econmically viable in recent
years.}.  The ability to transform power between voltages and transmit large
volumes over long distances allows for generation to take place at high
capacity stations (located away from large load centres and closer to fuel
sources) which offer economies of scale and lower operating costs.  It allows
electricity to be transmitted across country borders and from renewable
energy plant such as hydro power stations located in remote areas.

For delivery to most consumers, electric energy is transferred, at a
substation, from the transmission system to the grid supply point of a distribution
system.  Distribution networks are also three-phase AC systems, but
typically operate at lower voltages and differ in their general
structure/topology from transmission networks.  Transmission networks are
typically highly interconnected, providing several paths for power flow.
Whereas distribution networks, in rural areas, typically consist of long radial
feeders (usually overhead lines) or, in urban areas, consist of many ring
circuits.  Three-phase transformers, that step the voltage down to levels
more convenient for general use (typically from 11kV or 33kV to 400V), are spaced along the branches/rings. All three-phases at 400V may be provided for industrial and commercial loads
or individual phases at 230V supply typical domestic and other commercial
loads. Splitting of phases is usually planned so that each is loaded equally.
As explained in Appendix \ref{sec:power_system_model} this produces a balanced
symetrical system that may be analysed as a single phase circuit. Figure []
illustrates the basic sturcture of a typical national electric power system.

\section{Electricity Markets}
The UK was the first large country to privatise its electricity
supply industry.  The market structures that have since been adopted
implement some of the main principles behind electricity markets.

The England and Wales Electricity Pool was created in 1990 to break apart the
monolithic Central Electricity Generating Board (CEGB) and to gradually
introduce competition in generation and retail supply.  Early adoption of
electrcity markets by the UK has lead to the country hosting many of the
main European power and gas exchanges and the UK boasts a high degree
of consumer switching, an important factor in any competitive marketplace. The
Pool has since been replaced by trading arrangements in which market outcomes
are not centrally determined, but arise largely from bilateral agreements
between producers and suppliers.

\subsection{The England and Wales Electricity Pool}
\label{sec:thepool}
The Electric Lighting Act 1882 began the development of the UK's electricity
supply industry by allowing persons, companies and local authorities to set up
supply systems, principally at the time for the purposes of street lighting and
trams.  Under The Electricity Supply Act 1926 the Central Electricity Board
started operating the first grid of regional networks interconnected and
synchronised at 132kV, 50Hz in 1933.  This began operation as a national system
five years later in 1938 and was nationalised under The Electricity Act 1947
with the merger of over 600 electricity companies and the creation of the
British Electricity Authority.  This was dissolved and replaced with the
CEGB and the Electricity Council under The Electricity Act 1957.  The CEGB was
responsible for planning the network and generating sufficient electricity until the start of privatisation in 1990.

The industry was privatised under Prime Minister
Margaret Thatcher and The England and Wales Electricity Pool was created in
March 1990.  Control of the transmission system was transferred from the
CEGB to The National Grid Company, which was originally owned by twelve
regional electricity companies and is now publically listed.  The Pool was a
multilateral contractual arrangement between generators and suppliers and did
not itself buy or sell electricity.  Competition in generation was introduced
gradually, by entitling customers with consumption greater than or equal
to 1MW (approximately 45\% of the non-domestic market \cite{decc:dukes09}) to
purchase electricity form any listed supplier.  This limit was lowered in April
1994 to included customers with peak loads of 100kW or more.  Finally, between
September 1998 and March 1999 the market was opened to all customers.

Scheduling of generation was on a merit order basis (cheapest first) at a day
ahead stage and set a wholesale electricity price for each half-hour period of
the schedule day.  Forecasts of total demand in MW, based on historic data and
adjusted for factors such as the weather, for each settlement period were used
by generating companies and organisations with interconnects to the England
and Wales grid to formulate bids that had to be submitted to the grid operator
by 10AM on the day before the schedule day.

% TODO: Insert Pool bids figure.

Figure X illustrates the four of the five price parameters that bids consisted
of.  A start-up price would also be included, representing the cost of turning
on the generator from cold.  The no-load price $c_{noload}$ represents the
cost in pounds of keeping the generator running regardless of output. Three
incremental prices $c_1$, $c_2$ and $c_3$ specify the cost per MWh of
generation between set-points $p_1$, $p_2$ and $p_3$.

A settlement computer program was used to calculate an unconstrained schedule
(with no account being taken for the physical limitations of the transmission
system), meeting the forecast demand and requirements for reserve while minimising cost.
Cheapest bids up to the marginal point would get accepted first and the bid
price from the marginal generator would generally determine the system marginal
price for each settlement period.  The system marginal price would determine
the prices paid by consumers and paid to generators, which would be adjusted
such that that the costs of transmission are covered by the market and that the
availability of capacity is encouraged at certain times.

Variations in demand and changes in plant availability would be adjusted for by
the grid operator, producing a constrained schedule.  Generators having
submitted bids would be instructed to increase or reduce production
appropriately.  Alternatively, the grid operator could instruct large customers
with contracts to curtail their demand to do so or instruct generators
contracted to provide ancillary services to adjust production.

\subsection{British Electricity Transmission and Trading Arrangements}
\label{sec:betta}
Concerns over exploitation of market power in The England and Wales Electricity
Pool and its effectiveness in reducing consumer electricity prices prompted the
introduction of New Electricity Trading Arrangements (NETA) in March 2001
\cite{martoccia:2005}.  The aim was to improve efficiency and provide greater
choice to participants.  Control of the Scottish transmission system was
handed to England when the industry was integrated into the nationwide British
Electricity Transmission and Trading Arrangments (BETTA) in April 2005 under The Energy
Act 2004.  While The Pool operated a single daily auction and dispatched
plant centrally, under the new arrangements participants became
self-dispatching and market positions became determined through continuous
bilateral trading between generators, suppliers, traders and consumers.

The majority of power is traded under the BETTA through long-term contracts
that are customised to the requirements of each party \cite{kirschen:book}.
These suit participants responsible for large power plants or those purchasing
large volumes of power for many customers.  Considerable amounts of time and
effort are required to form these long-term contracts and this results in a
high associated transaction cost.  However, they reduce risk for large
players and a degree of flexibility can be provided through option contracts.

Power is also traded directly between participants through over-the-counter
contracts that are usually of a standardised form.  Such contracts
typically concern smaller volumes of power and have much lower associated
transaction costs.  Often they are used by participants to refine their market
position ahead of delivery time.

Trading facilities, such as power exchanges, provide a means for participants
to fine-tune their positions further, through short-term transactions for
relatively small quantities of energy.  Modern exchanges are computerised and
accept anonymous offers and bids submitted electronically.  A submitted
offer/bid will be paired with any outstanding bids/offers in the system with
compatible price and quantity values.  The details are then displayed for
traders to observe and use to educate their decisions.

All bilateral trading must be completed before ``gate-closure'' which is a
point in time, before delivery time, that gives the system operator an
opportunity to balance supply and demand and mitigate potential breaches of
system limits.  In keeping with the UK's free market philosphy, a competitive
spot market \cite{schweppe:spot} is used in the balancing process.  A
generator that is not fully loaded may offer a price at which it is willing to
increase its output by a specified quantity, stating the rate at which it is
capable of doing so.  Certain loads may also offer demand reductions at a
price which can typically be implemeted very quickly.  Longer-term contracts
for balancing services are also struck between the system operator and
generators/suppliers in order to avoid the price volatility often associated
with spot markets.

\section{Electricity Market Simulation}
Previous sections have shown the importance of electricity to
modern societies and have explained how its supply is trusted to unadministered
bilateral trading arrangements.  Electricity supply involves technology, money,
people, natural resources and the environment.  These aspects are all changing
and the discipline must be constantly researched to ensure that systems such as
electricity markets are fit for purpose.  The value of electricity to society
means that it is not feasible to experiment with radical changes to trading
arrangements on real systems.  A practical alternative is to create an abstract mathematical
model with a set of simplifying approximations and assumptions and find
analytical solutions by simulating the model using computer programs.

Game theory is the branch of applied mathematics in which behaviour in
strategic situations is captured.  A common approach to doing this is to
model the system and players as a mathematical optimisation problem.  Appendix
\ref{sec:opf} defines the optimal power flow problem, which is a classic
optimisation problem in the field of electric power Engineering.  Electricity
markets are commonly modelled using variations on the optimal power flow problem with
player strategies integrated[ref].  However, this thesis concerns
\textit{agent-based} simulation, which is an alternative approach to the mathematics of games.

\subsection{Agent-Based Simulation}
Social systems, such as electricity markets, are inherently complex and involve
interactions between different types of individuals and between individuals
and collective entities, such as organisations or groups, the behaviour of which
is itself the product of individual interactions.  This complexity
drives classical monolithic equilibrium models to their limits.  Models are
often highly stylised and limited to small numbers of players with strong
constraining assumptions made about their behaviour.

Agent-based simulation involves modelling simultaneous operations and
interactions between adaptive agents and assessing their effect on the system
as a whole.  Macro-level system properties arise from agent interactions, even
those with simple behavioural rules, that could not be deduced by simply
aggregating the agent's properties. % Game of Life

Following \cite{tesfatsi:handbook}, the objectives of agent-based modelling
research fall roughly into four strands: empirical, normative, heuristic and
methodological. The \textit{empirical} objectives are to understand how and why macro-level
regularities have evolved from micro-level interactions when little or no
top-down control is present.  Reaserch with \textit{normative} goals aims to
relate agent-based models to an ideal standard or optimal design.  The objective being
to evaluate proposed designs for social policy, institutions or processes in
their ability to produce socially desirable system performance.  The
\textit{heuristic} strand aims to generate theories on the fundamental causal
mechanisms in social systems that can be observed, even in simple systems, when there are
alternative initial conditions.  This thesis aims to provide
\textit{methodologial} advancement in the field.  Improvements in the tools
and methods available aid research with the former objectives.

%\section{Summary}
